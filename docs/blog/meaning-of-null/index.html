<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>A Quick and Thorough Guide to null</title><link rel="stylesheet" type="text/css" href="docbook.css"><link rel="stylesheet" type="text/css" href="article.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><meta name="description" content="What is the meaning of null? How is null implemented? When should you use null in your source code. And when should you not use it? These are the questions answered in this article."><meta name="keywords" content="null, null pointer"><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-162426780-1', 'ppl-lang.dev');
  ga('send', 'pageview');
</script></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="en" class="article"><div class="titlepage"><div><div><h2 class="title"><a name="MODIFY_THIS"></a>A Quick and Thorough Guide to <code class="code">null</code></h2></div><div><div class="author"><h3 class="author"><span class="firstname">Christian</span> <span class="surname">Neumanns</span></h3></div></div><div><p class="pubdate">2017-05-09</p></div><div><div class="abstract"><div class="abstract-title">Abstract</div><p>What is the meaning of <code class="code">null</code>? How is <code class="code">null</code> implemented? When should you use <code class="code">null</code> in your source code. And when should you <span class="emphasis"><em>not</em></span> use it? These are the questions answered in this article.</p></div></div></div><hr></div><div class="toc"><div class="toc-title">Table of Contents</div><dl class="toc"><dt><span class="section"><a href="#MODIFY_THIS">Introduction</a></span></dt><dt><span class="section"><a href="#MODIFY_THIS">Runtime Implementation</a></span></dt><dt><span class="section"><a href="#performance">Performance</a></span></dt><dt><span class="section"><a href="#value_types">Reference vs Value Types</a></span></dt><dt><span class="section"><a href="#meaning">Meaning</a></span></dt><dt><span class="section"><a href="#why_null">Why is it <code class="code">null</code>?</a></span></dt><dt><span class="section"><a href="#initialization">Initialization</a></span></dt><dt><span class="section"><a href="#usage">When to Use <code class="code">null</code> (And When Not to Use It)</a></span></dt><dt><span class="section"><a href="#null_safety">Null-safety</a></span></dt><dt><span class="section"><a href="#alternatives">Alternative Concepts</a></span></dt><dt><span class="section"><a href="#summary">Summary</a></span></dt></dl></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="MODIFY_THIS"></a>Introduction</h2></div></div></div><p><code class="code">null</code> is a fundamental and most important concept in many programming languages. It is ubiquitous in all kinds of source code written in these languages.  Hence it is essential to fully grasp the idea of <code class="code">null</code>. We have to understand its semantics and implementation, and we need to know how to correctly use <code class="code">null</code> in our source code.</p><p>Comments in programmer forums sometimes reveal a bit of confusion with <code class="code">null</code>.  Some programmers even try to completely avoid <code class="code">null</code>. Because they think of it as the 'million-dollar mistake', a term coined by Tony Hoare, the inventor of <code class="code">null</code>.</p><p>Here is a simple example: Suppose that Alice's <code class="code">email_address</code> points to <code class="code">null</code>. What does this mean? Does it mean that Alice doesn't have an email address? Or that her email address is unknown? Or that it is secret? Or does it simply mean that <code class="code">email_address</code> is 'undefined' or 'uninitialized'? Let's see. After reading this article, everybody should be able to answer such questions without hesitation.</p><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">This article is programming language-neutral - as far as possible. Explanations are general and not tied to a specific language. Please consult your programming language manuals for specific advice on <code class="code">null</code>. However, this article contains some simple source code examples shown in Java. But it's not difficult to translate them into your favorite language..</td></tr></table></div></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="MODIFY_THIS"></a>Runtime Implementation</h2></div></div></div><p>Before discussing the meaning of <code class="code">null</code> it is indispensable to understand how <code class="code">null</code> is implemented in memory at runtime.</p><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">We will have a look at a <span class="emphasis"><em>typical</em></span> implementation of <code class="code">null</code>. The actual implementation in a given environment depends on the programming language and target environment, and might differ from the implementation shown here.</td></tr></table></div><p>Suppose we have the following source code instruction:</p><pre class="programlisting">String name = "Bob";</pre><p>Here we declare a variable of type <code class="code">String</code> and with the identifier <code class="code">name</code> that points to the string <code class="code">"Bob"</code>.</p><p>Saying "points to" is important in this context because we are assuming that we work with <span class="emphasis"><em>reference types</em></span> (and not with <span class="emphasis"><em>value types</em></span>). More on this later.</p><p>To keep things simple we will make the following assumptions:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The above instruction is executed on a 16-bits CPU with a 16-bits address space.</p></li><li class="listitem"><p>Strings are encoded as UTF-16. They are terminated with 0 (as in C or C++).</p></li></ul></div><p>The following picture shows an excerpt of the memory after executing the above instruction:</p><div class="informalfigure"><div class="mediaobject"><img src="images/bob_pointer.png" alt="string pointer"><div class="caption"><p><span class="bold"><strong>Figure 1: Variable <code class="code">name</code> points to "Bob"</strong></span></p><br></div></div></div><p>The memory addresses in the above picture are chosen arbitrarily and are irrelevant for our discussion.</p><p>As we can see the string <code class="code">"Bob"</code> is stored at address B000 and occupies 4 memory cells.</p><p>Variable <code class="code">name</code> is located at address A0A1. The content of A0A1 is B000, which is the starting memory location of the string <code class="code">"Bob"</code>. That's why we say: The variable <code class="code">name</code> <span class="emphasis"><em>points to</em></span> <code class="code">"Bob"</code>.</p><p>So far so good.</p><p>Now suppose that, after executing the above instruction, the following one is executed:</p><pre class="programlisting">name = null;</pre><p>Now <code class="code">name</code> points to <code class="code">null</code>.</p><p>And this is the new state in memory:</p><div class="informalfigure"><div class="mediaobject"><img src="images/null_pointer.png" alt="string pointer"><div class="caption"><p><span class="bold"><strong>Figure 2: Variable <code class="code">name</code> points to <code class="code">null</code></strong></span></p><br></div></div></div><p>We can see that nothing has changed for the string <code class="code">"Bob"</code> which is still stored in memory.</p><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">The memory needed to store the string <code class="code">"Bob"</code> might later be released if there is a garbage collector and no other reference points to <code class="code">"Bob"</code>, but this is irrelevant in our discussion.</td></tr></table></div><p>What's important is that the content of A0A1 (which represents the value of variable <code class="code">name</code>) is now 0000. So, variable <code class="code">name</code> doesn't point to <code class="code">"Bob"</code> anymore. The value 0 (all bits at zero) is a typical value used in memory to denote <code class="code">null</code>. It means that there is <span class="emphasis"><em>no value associated with <code class="code">name</code></em></span>. You can also think of it as <span class="emphasis"><em>the absence of data</em></span> or simply <span class="emphasis"><em>no data</em></span>.</p><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The actual memory value used to denote <code class="code">null</code> is implementation-specific. For example the <a class="ulink" href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-2.html#jvms-2.4" target="_top">Java Virtual Machine Specification</a> states at the end of section <span class="emphasis"><em>2.4. Reference Types and Values</em></span>:</p><div class="blockquote"><blockquote class="blockquote">"The Java Virtual Machine specification does not mandate a concrete value encoding <code class="code">null</code>."</blockquote></div></td></tr></table></div><br><span class="bold"><strong>
		<p>Remember:</p>
		<div class="blockquote"><blockquote class="blockquote"><p>If a reference points to <code class="code">null</code>, it simply means that there is <span class="emphasis"><em>no value associated with it</em></span>.</p><p>Technically speaking, the memory location assigned to the reference contains the value 0 (all bits at zero), or any other value that denotes <code class="code">null</code> in the given environment.</p></blockquote></div>
	</strong></span></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance"></a>Performance</h2></div></div></div><p>We can deduce from the previous section that operations involving <code class="code">null</code> are extremely fast and easy to perform at runtime.</p><p>There are only two kinds of operations:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>initializing or setting a reference to <code class="code">null</code> (e.g. <code class="code">name = null</code>):</p><p>The only thing to do is to change the content of one memory cell (e.g. setting it to 0).</p></li><li class="listitem"><p>checking if a reference points to <code class="code">null</code> (e.g. <code class="code">if name == null</code>):</p><p>The only thing to do is to check if the memory cell of the reference holds the value 0.</p></li></ul></div><br><span class="bold"><strong>
		<p>Remember:</p>
		<div class="blockquote"><blockquote class="blockquote"><p><code class="code">null</code> operations are exceedingly fast and cheap.</p></blockquote></div>
	</strong></span></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="value_types"></a>Reference vs Value Types</h2></div></div></div><p>So far we assumed working with <span class="emphasis"><em>reference types</em></span>. The reason for this is simple: <code class="code">null</code> doesn't exist for <span class="emphasis"><em>value types</em></span>.</p><p>Why?</p><p>As we have seen previously, a reference is <span class="emphasis"><em>a pointer</em></span> to a memory-address that stores a value (e.g. a string, a date, a customer, whatever). If a reference points to <code class="code">null</code>, then no value is associated with it.</p><p>On the other hand, a value is, by definition, the value itself. There is no pointer involved. A value type is stored as the value itself. Therefore the concept of <code class="code">null</code> doesn't exist for value types.</p><p>The following picture demonstrates the difference. On the left side you can see again the memory in case of variable <code class="code">name</code> being a reference pointing to "Bob". The right side shows the memory in case of variable <code class="code">name</code> being a value type.</p><div class="informaltable"><table cellspacing="0" cellpadding="5" border="1"><colgroup><col><col></colgroup><tbody><tr><td>
						<span class="inlinemediaobject"><img src="images/bob_pointer.png"></span>
					</td><td>
						<span class="inlinemediaobject"><img src="images/value_type.png"></span>
					</td></tr><tr><td><span class="bold"><strong>Reference type</strong></span></td><td><span class="bold"><strong>Value type</strong></span></td></tr></tbody></table></div><p>As we can see, in case of a value type, the value itself is directly stored at the address A0A1 which is associated with variable <code class="code">name</code>.</p><p>There would be much more to say about reference versus value types, but this is out of the scope of this article. Please note also that some programming languages support only reference types, others support only value types, and some (e.g. C# and Java) support both of them.</p><br><span class="bold"><strong>
		<p>Remember:</p>
		<div class="blockquote"><blockquote class="blockquote"><p>The concept of <code class="code">null</code> exists only for reference types. It doesn't exist for value types.</p></blockquote></div>
	</strong></span></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="meaning"></a>Meaning</h2></div></div></div><p>Suppose we have a type <code class="code">person</code> with a field <code class="code">emailAddress</code>. Suppose also that, for a given person which we will call Alice, <code class="code">emailAddress</code> points to <code class="code">null</code>.</p><p>What does this mean? Does it mean that Alice doesn't have an email address? Not necessarily.</p><p>As we have seen already, what we can assert is that <span class="emphasis"><em>no value is associated with emailAddress</em></span>.</p><p>But <span class="emphasis"><em>why</em></span> is there no value? What is the reason of <code class="code">emailAddress</code> pointing to <code class="code">null</code>? If we don't know the context and history, then we can only speculate. The reason for <code class="code">null</code> <span class="emphasis"><em>could</em></span> be:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Alice doesn't have an email address</p></li><li class="listitem"><p>Alice has an email address but:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>it has not yet been entered in the database</p></li><li class="listitem"><p>it is secret (unrevealed for security reasons)</p></li><li class="listitem"><p>there is a bug in a routine that creates a person object without setting field <code class="code">emailAddress</code></p></li><li class="listitem"><p>etc. etc.</p></li></ul></div></li></ul></div><p>In practice we often know the application and context. We intuitively associate a precise meaning to <code class="code">null</code>. In a simple and flawless world, <code class="code">null</code> would simply mean that Alice actually doesn't have an email address.</p><p>When we write code, the reason <span class="emphasis"><em>why</em></span> a reference points to <code class="code">null</code> is often irrelevant. We just check for <code class="code">null</code> and take appropriate actions. For example, suppose that we have to write a loop that sends emails for a list of persons. The code (in Java) could look like this:</p><pre class="programlisting">for ( Person person: persons ) {
    if ( person.getEmailAddress() != null ) {
        // code to send email
    } else {
        logger.warning ( "No email address for " + person.getName() );
    }
}</pre><p>In the above loop we don't care about the reason for <code class="code">null</code>. We just acknowledge the fact that there is no email address, log a warning, and continue.</p><br><span class="bold"><strong>
		<p>Remember:</p>
		<div class="blockquote"><blockquote class="blockquote"><p>If a reference points to <code class="code">null</code> then it always means that there is <span class="emphasis"><em>no value associated with it</em></span>.</p><p>In most cases, <code class="code">null</code> has a more specific meaning that depends on the context.</p></blockquote></div>
	</strong></span></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="why_null"></a>Why is it <code class="code">null</code>?</h2></div></div></div><p>Sometimes it <span class="emphasis"><em>is</em></span> important to know <span class="emphasis"><em>why</em></span> a reference points to <code class="code">null</code>.</p><p>Consider the following function signature in a medical application:</p><pre class="programlisting">List&lt;Allergy&gt; getAllergiesOfPatient ( String patientId )</pre><p>In this case, returning <code class="code">null</code> (or an empty list) is ambiguous. Does it mean that the patient doesn't have allergies, or does it mean that an allergy test has not yet been performed? These are two semantically very different cases that must be handled differently. Or else the outcome might be life-threatening. Just suppose that the patient has allergies, but an allergy test has not yet been done and the software tells the doctor that 'there are no allergies'. Hence we need additional information. We need to know <span class="emphasis"><em>why</em></span> the function returns <code class="code">null</code>.</p><p>It would be tempting to say: Well, to differentiate, we return <code class="code">null</code> if an allergy test has not yet been performed, and we return an empty list if there are no allergies.</p><p>DON'T DO THIS!</p><p>This is bad data design for multiple reasons;</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>The different semantics for returning <code class="code">null</code> versus returning an empty list would need to be well documented. And as we all know, comments can be wrong (i.e. inconsistent with the code), outdated, or they might even be inaccessible.</p></li><li class="listitem"><p>There is no protection for misuses in client code that calls the function. For example, the following code is wrong, but it compiles without errors. Moreover, the error is difficult to spot for a human reader. We can't see the error by just looking at the code without considering the comment of <code class="code">getAllergiesOfPatient</code></p><pre class="programlisting">List&lt;Allergy&gt; allergies = getAllergiesOfPatient ( "123" );
				
if ( allergies == null ) {
    System.out.println ( "No allergies" );                   // &lt;-- WRONG!
} else if ( allergies.isEmpty() ) {
    System.out.println ( "Test not done yet" );              // &lt;-- WRONG!
} else {
    System.out.println ( "There are allergies" );
}</pre><p>The following code would be wrong too:</p><pre class="programlisting">List&lt;Allergy&gt; allergies = getAllergiesOfPatient ( "123" );
if ( allergies == null || allergies.isEmpty() ) {
    System.out.println ( "No allergies" );                   // &lt;-- WRONG!
} else {
    System.out.println ( "There are allergies" );
}</pre></li><li class="listitem"><p>If the <code class="code">null</code>/empty-logic of <code class="code">getAllergiesOfPatient</code> changes in the future, then the comment needs to be updated, as well as all client code. And there is no protection against forgetting anyone of these changes.</p></li><li class="listitem"><p>If, later on, there is another case to be distinguished (e.g. an allergy test is pending - the results are not yet available), or if we want to add specific data for each case, then we are stuck.</p></li><li class="listitem"><p>The article <a class="ulink" href="https://www.codeproject.com/Articles/797453/Is-it-Really-Better-to-Return-an-Empty-List-Inst" target="_top">Is it Really Better to 'Return an Empty List Instead of null'? - Part 2</a> explains why it is generally a bad idea to return empty lists (and empty strings), especially in programming languages with compile-time <code class="code">null</code>-safety. Functions should return <code class="code">null</code> (if appropriate) or a <span class="emphasis"><em>non-empty and immutable</em></span> list. Please refer to the article for further explanations.</p></li></ol></div><p>Obviously, the function must return more information than just a list.</p><p>There are different ways to do this, depending on the programming language we use. Let's have a look at a <span class="emphasis"><em>possible</em></span> solution in Java.</p><p>In order to differentiate the cases, we define a parent type <code class="code">AllergyTestResult</code>, as well as three sub-types that represent the three cases (<code class="code">NotDone</code>, <code class="code">Pending</code>, and <code class="code">Done</code>):</p><pre class="programlisting">interface AllergyTestResult {}</pre><pre class="programlisting">interface NotDoneAllergyTestResult extends AllergyTestResult {}</pre><pre class="programlisting">interface PendingAllergyTestResult extends AllergyTestResult {
    public Date getDateStarted();
}</pre><pre class="programlisting">interface DoneAllergyTestResult extends AllergyTestResult {
    public Date getDateDone();
    public List&lt;Allergy&gt; getAllergies(); // null if no allergies
                                         // non-empty if there are allergies
}</pre><p>As we can see, for each case we can have specific data associated with it.</p><p>Instead of simply returning a list, <code class="code">getAllergiesOfPatient</code> now returns an <code class="code">AllergyTestResult</code> object:</p><pre class="programlisting">AllergyTestResult getAllergiesOfPatient ( String patientId )</pre><p>Client code is now less error-prone and looks like this:</p><pre class="programlisting">AllergyTestResult allergyTestResult = getAllergiesOfPatient ( "123" );

if ( allergyTestResult instanceof NotDoneAllergyTestResult ) {
    System.out.println ( "Test not done yet" );
   
} else if ( allergyTestResult instanceof PendingAllergyTestResult ) {
    System.out.println ( "Test pending" );
   
} else if ( allergyTestResult instanceof DoneAllergyTestResult ) {
    List&lt;Allergy&gt; list = ((DoneAllergyTestResult) allergyTestResult).getAllergies();
    if ( list == null ) {
        System.out.println ( "No allergies" );
    } else if ( list.isEmpty () ) {
        assert false;
    } else {
        System.out.println ( "There are allergies" );
    }
} else {
    assert false;
}</pre><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>If you think that the above code is quite verbose and a bit hard to write then you are not alone.</p><p>Some modern languages allow us to write conceptually similar code much more succinctly. And null-safe languages distinguish between nullable and non-nullable values in a reliable way at compile-time - there is no need to comment the nullability of a reference or to check whether a reference declared to be non-null has accidentally been set to <code class="code">null</code>.</p></td></tr></table></div><br><span class="bold"><strong>
		<p>Remember:</p>
		<div class="blockquote"><blockquote class="blockquote"><p>If we need to know <span class="emphasis"><em>why</em></span> there is no value associated with a reference then additional data must be provided in order to differentiate the possible cases.</p></blockquote></div>
	</strong></span></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="initialization"></a>Initialization</h2></div></div></div><p>Consider the following instructions:</p><pre class="programlisting">String s1 = "foo";
String s2 = null;
String s3;</pre><p>The first instruction declares a <code class="code">String</code> variable <code class="code">s1</code> and assigns it the value <code class="code">"foo"</code>.</p><p>The second instruction assigns <code class="code">null</code> to <code class="code">s2</code>.</p><p>The more interesting instruction is the last one. No value is explicitly assigned to <code class="code">s3</code>. Hence, it is reasonable to ask: What is the state of <code class="code">s3</code> after its declaration? What will happen if we write <code class="code">s3</code> to the OS output device?</p><p>It turns out that the state of a variable (or class field) declared without assigning a value depends on the programming language. Moreover, each programming language might have specific rules for different cases. For example, different rules apply for reference types and value types, static and non-static members of a class, global and local variables, etc.</p><p>As far as I know the following rules are typical variations encountered:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>It is illegal to declare a variable without also assigning a value</p></li><li class="listitem"><p>There is an arbitrary value stored in <code class="code">s3</code>, depending on the memory content at the time of execution - there is no default value</p></li><li class="listitem"><p>A default value is automatically assigned to <code class="code">s3</code>:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>in case of a reference type, the default value is <code class="code">null</code></p></li><li class="listitem"><p>in case of a value type, the default value depends on the variable's type. For example <code class="code">0</code> for integer numbers, <code class="code">false</code> for a boolean, etc.</p></li></ul></div></li><li class="listitem"><p>the state of <code class="code">s3</code> is 'undefined'</p></li><li class="listitem"><p>the state of <code class="code">s3</code> is 'uninitialized' and any attempt to use <code class="code">s3</code> results in a compile-time error.</p></li></ul></div><p>The best option is the last one. All other options are error-prone and/or impractical - for reasons we will not discuss here, because this article focuses on <code class="code">null</code>.</p><p>As an example, Java applies the last option for local variables. Hence, the following code results in a compile-time error at the second line:</p><pre class="programlisting">String s3;
System.out.println ( s3 );</pre><p>Compiler output:</p><pre class="screen">error: variable s3 might not have been initialized</pre><br><span class="bold"><strong>
		<p>Remember:</p>
		<div class="blockquote"><blockquote class="blockquote"><p>If a variable is declared, but no explicit value is assigned to it, then it's state depends on several factors which are different in different programming languages.</p><p>In some languages <code class="code">null</code> is the default value for reference types.</p></blockquote></div>
	</strong></span></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="usage"></a>When to Use <code class="code">null</code> (And When Not to Use It)</h2></div></div></div><p>The basic rule is simple: <code class="code">null</code> should only be allowed when it makes sense for an object reference to have 'no value associated with it'. (Note: an object reference can be a variable, constant, property (class field), input/output argument, etc.)</p><p>For example, suppose type <code class="code">person</code> with fields <code class="code">name</code> and <code class="code">dateOfFirstMarriage</code>:</p><pre class="programlisting">interface Person {
    public String getName();
    public Date getDateOfFirstMarriage();
}</pre><p>Every person has a name. Hence it doesn't make sense for field <code class="code">name</code> to have 'no value associated with it'. Field <code class="code">name</code> is <span class="emphasis"><em>non-nullable</em></span>. It is illegal to assign <code class="code">null</code> to it.</p><p>On the other hand, field <code class="code">dateOfFirstMarriage</code> doesn't represent a required value. Not everyone is married. Hence it makes sense for <code class="code">dateOfFirstMarriage</code> to have 'no value associated with it'. Therefore <code class="code">dateOfFirstMarriage</code> is a <span class="emphasis"><em>nullable</em></span> field. If a person's <code class="code">dateOfFirstMarriage</code> field points to <code class="code">null</code> then it simply means that this person has never been married.</p><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Unfortunately most popular programming languages don't distinguish between nullable and non-nullable types. There is no way to reliably state that <code class="code">null</code> can never be assigned to a given object reference. In some languages it is possible to use annotations, such as the non-standard annotations @Nullable and @NonNullable in Java. Here is an example:</p><pre class="programlisting">interface Person {
    public @Nonnull String getName();
    public @Nullable Date getDateOfFirstMarriage();
}</pre><p>However, such annotations are not used by the compiler to ensure null-safety. Still, they are useful for the human reader, and they can be used by IDEs and tools such as static code analysers.</p></td></tr></table></div><br><p>It is important to note that <code class="code">null</code> should not be used to denote error conditions.</p><p>Consider a function that reads configuration data from a file. If the file doesn't exist or is empty then a default configuration should be returned. Here is the function's signature:</p><pre class="programlisting">public Config readConfigFromFile ( File file )</pre><p>What should happen in case of a file read error?</p><p>Simply return <code class="code">null</code>?</p><p>NO!</p><p>Each language has it's own standard way to signal error conditions and provide data about the error, such as a description, type, stack trace etc. Many languages (C#, Java, etc.) use an exception mechanisms, and exceptions should be used in these languages to signal runtime errors. Hence, <code class="code">readConfigFromFile</code> should not return <code class="code">null</code> to denote an error. Instead, the function's signature should be changed in order to make it clear that the function might fail:</p><pre class="programlisting">public Config readConfigFromFile ( File file ) throws IOException</pre><br><span class="bold"><strong>
		<p>Remember:</p>
		<div class="blockquote"><blockquote class="blockquote"><p>Allow <code class="code">null</code> only if it makes sense for an object reference to have 'no value associated with it'.</p><p>Don't use <code class="code">null</code> to signal error conditions.</p></blockquote></div>
	</strong></span></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="null_safety"></a>Null-safety</h2></div></div></div><p>Consider the following code:</p><pre class="programlisting">String name = null;
int l = name.length();</pre><p>At runtime, the above code results in the infamous <span class="emphasis"><em>null pointer error</em></span>, because we try to execute a method of a reference that points to <code class="code">null</code>. In C#, for example, a <code class="code">NullReferenceException</code> is thrown, in Java it is a <code class="code">NullPointerException</code>.</p><p>The null pointer error is nasty.</p><p>It is the <span class="emphasis"><em>most frequent bug</em></span> in many software applications and has been the cause for countless troubles in the history of software development. Tony Hoare, the inventor of <code class="code">null</code>, calls it the 'billion-dollar mistake'.</p><p>But Tony Hoare (Turing Award winner in 1980 and inventor of the Quicksort algorithm), also gives a hint to a solution in his <a class="ulink" href="https://qconlondon.com/london-2009/qconlondon.com/london-2009/speaker/Tony+Hoare.html" target="_top">speech</a>:</p><div class="blockquote"><blockquote class="blockquote"><p>"More recent programming languages like Spec# have introduced declarations for non-null references. This is the solution, which I rejected in 1965."</p></blockquote></div><p>Contrary to some common belief, the culprit is not <code class="code">null</code> per se. The problem is the <span class="emphasis"><em>lack of support for <code class="code">null</code> handling</em></span> in many programming languages. For example, at the time of writing (May 2017), none of the top ten languages in the <a class="ulink" href="https://www.tiobe.com/tiobe-index/" target="_top">Tiobe index</a> natively differentiates between nullable and non-nullable types.</p><p>Therefore, some new languages provide compile-time null-safety and specific syntax for conveniently handling <code class="code">null</code> in source code. In these languages the above code would result in a compile-time error. Software quality and reliability increases considerably because the null pointer error delightfully disappears.</p><p>Null-safety is a fascinating topic that deserves its own article.</p><br><span class="bold"><strong>
		<p>Remember:</p>
		<div class="blockquote"><blockquote class="blockquote"><p>Whenever possible, use a language that supports <span class="emphasis"><em>compile-time null-safety</em></span>.</p></blockquote></div>
	</strong></span></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="alternatives"></a>Alternative Concepts</h2></div></div></div><p>Besides the concept of <code class="code">null</code>, there are other concepts used to denote the 'absence of a value' and avoid null pointer errors, most notably:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>the <span class="emphasis"><em>Optional/Maybe Pattern</em></span> (often used in functional programming languages)</p></li><li class="listitem"><p>the <span class="emphasis"><em>Null Object Pattern</em></span></p></li></ul></div><p>You can read more about these in my previous article <a class="ulink" href="https://www.codeproject.com/Articles/787668/Why-We-Should-Love-null" target="_top">Why We Should Love <code class="code">null</code></a>.</p></div><div lang="en" class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="summary"></a>Summary</h2></div></div></div><p>Here is a summary of key points to remember:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>If a reference points to <code class="code">null</code>, it always means that there is <span class="emphasis"><em>no value associated with it</em></span>.</p><p>In most cases, <code class="code">null</code> has a more specific meaning that depends on the context.</p></li><li class="listitem"><p>If we need to know <span class="emphasis"><em>why</em></span> there is no value associated with a reference then additional data must be provided in order to differentiate the possible cases.</p></li><li class="listitem"><p>Allow <code class="code">null</code> only if it makes sense for an object reference to have 'no value associated with it'.</p></li><li class="listitem"><p>Don't use <code class="code">null</code> to signal error conditions.</p></li><li class="listitem"><p>The concept of <code class="code">null</code> exists only for reference types. It doesn't exist for value types.</p></li><li class="listitem"><p>In some languages <code class="code">null</code> is the default value for reference types.</p></li><li class="listitem"><p><code class="code">null</code> operations are exceedingly fast and cheap.</p></li><li class="listitem"><p>Whenever possible, use a language that supports compile-time null-safety.</p></li></ul></div></div></div></body></html>
